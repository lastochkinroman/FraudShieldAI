const { getSaluteSpeechToken, getGigaChatToken } = require('../config/tokens');
const { formatStats } = require('../utils/helpers');

async function handleStartCommand(ctx) {
  await ctx.reply('ü§ñ *–ë–æ—Ç-–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∑–≤–æ–Ω–∫–æ–≤ –¥–ª—è —Å–ª—É–∂–±—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –±–∞–Ω–∫–∞*\n\n' +
    '–û—Ç–ø—Ä–∞–≤—å—Ç–µ –∞—É–¥–∏–æ–∑–∞–ø–∏—Å—å —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–æ–≥–æ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞, –∏ –±–æ—Ç:\n' +
    '‚Ä¢ –†–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Ä–µ—á—å\n' +
    '‚Ä¢ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞\n' +
    '‚Ä¢ –î–∞—Å—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä—É\n\n' +
    '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /test –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤\n' +
    '/stats –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏\n' +
    '/example –¥–ª—è –ø—Ä–∏–º–µ—Ä–æ–≤ –æ–ø–∞—Å–Ω—ã—Ö —Ñ—Ä–∞–∑\n' +
    '/demo –¥–ª—è –¥–µ–º–æ-–∑–∞–ø–∏—Å–∏', { parse_mode: 'Markdown' });
}

async function handleTestCommand(ctx) {
  try {
    await ctx.reply('üß™ –¢–µ—Å—Ç–∏—Ä—É—é —Ç–æ–∫–µ–Ω—ã...');

    try {
      const speechToken = await getSaluteSpeechToken();
      await ctx.reply(`‚úÖ SaluteSpeech —Ç–æ–∫–µ–Ω: ${speechToken ? '–†–∞–±–æ—Ç–∞–µ—Ç' : '–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç'}`);
    } catch (error) {
      await ctx.reply(`‚ùå SaluteSpeech —Ç–æ–∫–µ–Ω: ${error.message}`);
    }

    try {
      await getGigaChatToken();
      await ctx.reply('‚úÖ GigaChat —Ç–æ–∫–µ–Ω: –†–∞–±–æ—Ç–∞–µ—Ç');
    } catch (error) {
      await ctx.reply(`‚ùå GigaChat —Ç–æ–∫–µ–Ω: ${error.message}`);
    }

  } catch (error) {
    await ctx.reply(`‚ùå –û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ${error.message}`);
  }
}

async function handleStatsCommand(ctx) {
  await ctx.reply(formatStats(), { parse_mode: 'Markdown' });
}

async function handleExampleCommand(ctx) {
  await ctx.reply(
    `üé≠ *–ü—Ä–∏–º–µ—Ä—ã –æ–ø–∞—Å–Ω—ã—Ö —Ñ—Ä–∞–∑ –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏*\n\n` +
    `–ó–∞–ø–∏—à–∏—Ç–µ —ç—Ç–∏ —Ñ—Ä–∞–∑—ã –≥–æ–ª–æ—Å–æ–º –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É:\n\n` +
    `1. "–ú–Ω–µ –Ω—É–∂–Ω–æ —Å—Ä–æ—á–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –¥–µ–Ω—å–≥–∏ –Ω–∞ –∑–∞—â–∏—Ç–Ω—ã–π —Å—á–µ—Ç, –º–Ω–µ –∑–≤–æ–Ω–∏–ª–∏ –∏–∑ –≤–∞—à–µ–π —Å–ª—É–∂–±—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!"\n\n` +
    `2. "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∏—á–µ–≥–æ –Ω–µ –±–ª–æ–∫–∏—Ä—É–π—Ç–µ! –ú–Ω–µ —Å–∫–∞–∑–∞–ª–∏, —á—Ç–æ –µ—Å–ª–∏ —è –Ω–µ –ø–µ—Ä–µ–≤–µ–¥—É –¥–µ–Ω—å–≥–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ —á–∞—Å–∞, —Å—á–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä—É—é—Ç!"\n\n` +
    `3. "–≠—Ç–æ –ø–µ—Ä–µ–≤–æ–¥ –º–æ–µ–π —Å–µ—Å—Ç—Ä–µ –≤ –±–æ–ª—å–Ω–∏—Ü—É, –æ—á–µ–Ω—å —Å—Ä–æ—á–Ω–æ! –ù–µ –∑–∞–¥–∞–≤–∞–π—Ç–µ –ª–∏—à–Ω–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤!"\n\n` +
    `4. "–ú–Ω–µ –∑–≤–æ–Ω–∏–ª –≤–∞—à —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –ò–≤–∞–Ω, –æ–Ω —Å–∫–∞–∑–∞–ª –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤—Å–µ –¥–µ–Ω—å–≥–∏ –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—á–µ—Ç 2200..."\n\n` +
    `5. "–ú–Ω–µ —Å–∫–∞–∑–∞–ª–∏ –∏–∑ —Å–ª—É–∂–±—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±–∞–Ω–∫–∞, —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–∞ —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–Ω–µ –Ω—É–∂–Ω–æ —Å—Ä–æ—á–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤—Å–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–∞ –Ω–æ–≤—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å—á–µ—Ç, –∏–Ω–∞—á–µ –¥–µ–Ω—å–≥–∏ —É–∫—Ä–∞–¥—É—Ç!"`,
    { parse_mode: 'Markdown' }
  );
}

async function handleDemoCommand(ctx) {
  await ctx.reply(
    `üé¨ *–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏*\n\n` +
    `*–°—Ü–µ–Ω–∞—Ä–∏–π 1: –û—á–µ–≤–∏–¥–Ω–æ–µ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ*\n` +
    `–ó–∞–ø–∏—Å—å: "–ê–ª–ª–æ? –ú–Ω–µ –∑–≤–æ–Ω–∏–ª–∏ –∏–∑ –≤–∞—à–µ–π —Å–ª—É–∂–±—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏! –ì–æ–≤–æ—Ä—è—Ç, —á—Ç–æ –Ω–∞ –º–æ—é –∫–∞—Ä—Ç—É –ø—ã—Ç–∞—é—Ç—Å—è –≤–∑—è—Ç—å –∫—Ä–µ–¥–∏—Ç! –ù—É–∂–Ω–æ —Å—Ä–æ—á–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤—Å–µ –¥–µ–Ω—å–≥–∏ –Ω–∞ –∑–∞—â–∏—Ç–Ω—ã–π —Å—á–µ—Ç 2200 1234 5678 9012! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∏—á–µ–≥–æ –Ω–µ –±–ª–æ–∫–∏—Ä—É–π—Ç–µ, —É –º–µ–Ω—è –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ 10 –º–∏–Ω—É—Ç!"\n\n` +
    `*–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–≥—Ä–∞–Ω–∏—á–Ω—ã–π —Å–ª—É—á–∞–π*\n` +
    `–ó–∞–ø–∏—Å—å: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –º–Ω–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ 50 —Ç—ã—Å—è—á —Ä—É–±–ª–µ–π —Å—ã–Ω—É. –û–Ω –≤ –¥—Ä—É–≥–æ–º –≥–æ—Ä–æ–¥–µ, –ø–æ–ø–∞–ª –≤ –∞–≤–∞—Ä–∏—é. –û—á–µ–Ω—å —Å—Ä–æ—á–Ω–æ –Ω—É–∂–Ω–æ –æ–ø–ª–∞—Ç–∏—Ç—å –ª–µ—á–µ–Ω–∏–µ."\n\n` +
    `*–°—Ü–µ–Ω–∞—Ä–∏–π 3: –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å*\n` +
    `–ó–∞–ø–∏—Å—å: "–î–æ–±—Ä—ã–π –¥–µ–Ω—å. –ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∫–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π —Å—á–µ—Ç? –ò –∫–∞–∫–∏–µ —É –≤–∞—Å –µ—Å—Ç—å —É—Å–ª–æ–≤–∏—è –ø–æ –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º?"`,
    { parse_mode: 'Markdown' }
  );
}

async function handleUnknownText(ctx) {
  await ctx.reply('–û—Ç–ø—Ä–∞–≤—å—Ç–µ –≥–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–ª–∏ –∞—É–¥–∏–æ—Ñ–∞–π–ª –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /start –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏.');
}

module.exports = {
  handleStartCommand,
  handleTestCommand,
  handleStatsCommand,
  handleExampleCommand,
  handleDemoCommand,
  handleUnknownText
};
